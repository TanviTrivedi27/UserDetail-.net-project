@model List<GlobalEntity.User>

    <div class="card">
        
        <div class="card-body">
        <a class="btn btn-success" asp-controller="User" asp-action="Create">Add New</a>
            <div class="card-title">
            <h2>
              User Listing
            </h2>
            </div>
        <table class="table table-bordered table-striped"" id='userlist'>
                <thead class="bg-dark text-white">
                    <tr>
                        <td>Id</td>
                        <td>FirstName</td>
                        <td>LastName</td>
                        <td>Email</td>
                        <td>Mobile</td>
                        <td>CreatedDate</td>
                        <td>DOB</td>
                        <td>Action</td>

                    </tr>
                </thead>
                <tbody>
                   @*  @foreach(var item in Model)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(itemdisplay=>item.Id)
                            @Html.HiddenFor(itemdisplay=>item.Id)
                        </td>
                        <td>
                            @Html.DisplayFor(itemdisplay=>item.FirstName)
                        </td>
                        <td>
                            @Html.DisplayFor(itemdisplay=>item.LastName)
                        </td>
                        <td>
                            @Html.DisplayFor(itemdisplay=>item.Email)
                        </td>
                        <td>
                            @Html.DisplayFor(itemdisplay=>item.Mobile)
                        </td>
                        <td>
                            @Html.DisplayFor(itemdisplay=>item.CreatedDate)
                        </td>
                        <td>
                            @Html.DisplayFor(itemdisplay=>item.DOB)
                        </td>
                        <td>
                            <a onclick="FunEdit(this)" class="btn btn-primary">Edit</a> | <a onclick="FunRemove(this)" class="btn btn-danger">Remove</a> |
                            <a class="btn btn-primary">Detail</a>
                        </td>
                    </tr>
                } *@
            </tbody>
            </table>

        </div>
    </div>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.css" />
<script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.js"></script>

    <script type="text/javascript">
        var js = jQuery.noConflict(true);
        js(document).ready(function () {
        // js('#userlist').DataTable({

        //     });
        LoadListing();
        });
    function FunEdit(element)
    {
        var id = $(element).closest('tr').find('input[type=hidden]').val();
        window.location.href = "/user/Edit?id="+id;
    }

    function FunRemove(element) {
        var id = $(element).closest('tr').find('input[type=hidden]').val();
        if (confirm("do you want to remove?")) 
        { 
            $.ajax({
                type: "POST",
                url: "/User/Remove",
                data: { id: id },
                success: function (data) {
                    if (data == 'pass') {
                        alert('Removed Successfuly');
                        window.location.reload();
                    } else {
                        alert("Failure due to:" + data)
                    }
                },
                failure: function (err) {

                }
            });
        }
        //window.location.href = "/user/Edit?id=" + id;
    }

    function LoadListing(){
        var userdata = [];
        $.ajax({
            type: "POST",
            url: "/User/GetAll"
            async:false,
            success: function (data) {
                $.each(data,function(key,value){
                    var editbtn = "<a onclick='FunEdit(this)' class='btn btn - primary'>Edit</a>";
                    var removebtn = "<a onclick='FunRemove(this)' class='btn btn - danger'>Remove</a>";
                    var detailbtn = "<a class='btn btn-primary'>Detail</a>";
                    var hdn = "<input type='hidden' value=" + value.id + "/>";
                    var action = editbtn +"|"+ removebtn +"|"+ detailbtn + hdn;
                    userdata.push([value.id,value.fname,value.lname,value.email,value.mobile,value.createddate,value.dob,action])
                })
            },
            failure: function (err) {

            }
        });
        
        js('#userlist').DataTable({
            data: userdata;
        });

    }
    </script>
